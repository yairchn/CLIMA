<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MoistThermodynamics · CLIMA</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../index.html"><img class="logo" src="../../assets/logo.png" alt="CLIMA logo"/></a><h1>CLIMA</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Home</a></li><li><span class="toctext">Utilites</span><ul><li><a class="toctext" href="../RootSolvers/">RootSolvers</a></li><li class="current"><a class="toctext" href>MoistThermodynamics</a><ul class="internal"><li><a class="toctext" href="#Functions-1">Functions</a></li></ul></li></ul></li><li><span class="toctext">Atmos</span><ul><li><a class="toctext" href="../../Atmos/SurfaceFluxes/"><code>SurfaceFluxes</code></a></li><li><a class="toctext" href="../../Atmos/TurbulenceConvection/"><code>TurbulenceConvection</code></a></li><li><a class="toctext" href="../../Atmos/EDMFEquations/">Eddy-Diffusivity Mass-Flux (EDMF) equations</a></li></ul></li><li><a class="toctext" href="../../ODESolvers/">ODESolvers</a></li><li><a class="toctext" href="../../Mesh/">Mesh</a></li><li><a class="toctext" href="../../AtmosDycore/">AtmosDycore</a></li><li><a class="toctext" href="../../Arrays/">Arrays</a></li><li><a class="toctext" href="../../DGmethods/">DGmethods</a></li><li><span class="toctext">Developer docs</span><ul><li><a class="toctext" href="../../CodingConventions/">Coding Conventions</a></li><li><a class="toctext" href="../../AcceptableUnicode/">Acceptable Unicode characters</a></li><li><a class="toctext" href="../../VariableList/">CliMA Variable List</a></li></ul></li><li><span class="toctext">Balance Law Examples</span><ul><li><a class="toctext" href="../../BalanceLawOverview/">DG Balance Law Method</a></li><li><a class="toctext" href="../../examples/DGmethods/generated/ex_001_periodic_advection/">Example 001: Periodic Advection</a></li><li><a class="toctext" href="../../examples/DGmethods/generated/ex_002_solid_body_rotation/">Example 002: Solid Body Rotation</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Utilites</li><li><a href>MoistThermodynamics</a></li></ul><a class="edit-page" href="https://github.com/climate-machine/CLIMA/blob/master/docs/src/Utilities/MoistThermodynamics.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>MoistThermodynamics</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="MoistThermodynamics-Module-1" href="#MoistThermodynamics-Module-1">MoistThermodynamics Module</a></h1><p>The <code>MoistThermodynamics</code> module provides all thermodynamic functions needed for the atmosphere and functions shared across model components. The functions are general for a moist atmosphere that includes suspended cloud condensate in the working fluid; the special case of a dry atmosphere is obtained for zero specific humidities (or simply by omitting the optional specific humidity arguments in the functions that are needed for a dry atmosphere). The general formulation assumes that there are tracers for the total water specific humidity <code>q_tot</code>, the liquid specific humidity <code>q_liq</code>, and the ice specific humidity <code>q_ice</code> to characterize the thermodynamic state and composition of moist air.</p><p>There are several types of functions:</p><ol><li>Equation of state (ideal gas law):<ul><li><code>air_pressure</code></li></ul></li><li>Specific gas constant and isobaric and isochoric specific heats of moist air:<ul><li><code>gas_constant_air</code></li><li><code>cp_m</code></li><li><code>cv_m</code></li></ul></li><li>Specific latent heats of vaporization, fusion, and sublimation:<ul><li><code>latent_heat_vapor</code></li><li><code>latent_heat_fusion</code></li><li><code>latent_heat_sublim</code></li></ul></li><li>Saturation vapor pressure and specific humidity over liquid and ice:<ul><li><code>sat_vapor_press_liquid</code></li><li><code>sat_vapor_press_ice</code></li><li><code>sat_shum</code></li></ul></li><li>Functions computing energies and inverting them to obtain temperatures<ul><li><code>total_energy</code></li><li><code>internal_energy</code></li><li><code>air_temperature</code></li></ul></li><li>Functions to compute temperatures and partitioning of water into phases in thermodynamic equilibrium (when Gibbs&#39; phase rule implies that the entire thermodynamic state of moist air, including the liquid and ice specific humidities, can be calculated from the 3 thermodynamic state variables, such as energy, pressure, and total specific humidity)<ul><li><code>liquid_fraction_equil</code> (fraction of condensate that is liquid)</li><li><code>saturation_adjustment</code> (compute temperature from energy, density, and total specific humidity)</li></ul></li><li>Auxiliary functions for diagnostic purposes, e.g., other thermodynamic quantities<ul><li><code>liquid_ice_pottemp</code> (liquid-ice potential temperature)</li></ul></li></ol><p>A moist dynamical core that assumes equilibrium thermodynamics can be obtained from a dry dynamical core with total energy as a prognostic variable by including a tracer for the total specific humidity <code>q_tot</code>, using the functions, e.g., for the energies in the module, and computing the temperature <code>T</code> and the liquid and ice specific humidities (<code>q.liq</code> and <code>q.ice</code>) from the internal energy <code>e_int</code> by saturation adjustment:</p><pre><code class="language-julia">T = saturation_adjustment(e_int, ρ, q_tot);
q = PhasePartition_equil(T, ρ, q_tot);</code></pre><p>here, <code>ρ</code> is the density of the moist air, and the internal energy <code>e_int = e_tot - e_kin - geopotential</code> is the total energy <code>e_tot</code> minus kinetic energy <code>e_kin</code> and potential energy <code>geopotential</code> (all energies per unit mass). No changes to the &quot;right-hand sides&quot; of the dynamical equations are needed for a moist dynamical core that supports clouds, as long as they do not precipitate. Additional source-sink terms arise from precipitation.</p><p>Schematically, the workflow in such a core would look as follows:</p><pre><code class="language-julia"># initialize
geopotential = grav * z
q_tot          = ...
ρ            = ...

(u, v, w)    = ...
e_kin           = 0.5 * (u^2 + v^2 + w^2)

e_tot        = total_energy(e_kin, geopotential, T, q_tot)

do timestep   # timestepping loop

  # advance dynamical variables by a timestep (temperature typically
  # appears in terms on the rhs, such as radiative transfer)
  advance(u, v, w, ρ, e_tot, q_tot)

  # compute internal energy from dynamic variables
  e_int = e_tot - 0.5 * (u^2 + v^2 + w^2) - geopotential

  # compute temperature, pressure and condensate specific humidities,
  T = saturation_adjustment(e_int, ρ, q_tot);
  q = PhasePartition_equil(T, ρ, q_tot);
  p = air_pressure(T, ρ, q)

end</code></pre><p>For a dynamical core that additionally uses the liquid and ice specific humidities <code>q.liq</code> and <code>q.ice</code> as prognostic variables, and thus explicitly allows the presence of non-equilibrium phases such as supercooled water, the saturation adjustment in the above workflow is replaced by a direct calculation of temperature and pressure:</p><pre><code class="language-julia">T = air_temperature(e_int, q)
p = air_pressure(T, ρ, q)</code></pre><h2><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.PhasePartition" href="#CLIMA.MoistThermodynamics.PhasePartition"><code>CLIMA.MoistThermodynamics.PhasePartition</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">PhasePartition</code></pre><p>Represents the mass fractions of the moist air mixture.</p><p><strong>Constructors</strong></p><pre><code class="language-none">PhasePartition(q_tot::Real[, q_liq::Real[, q_ice::Real]])
PhasePartition(ts::ThermodynamicState)</code></pre><p>See also <a href="#CLIMA.MoistThermodynamics.PhasePartition_equil"><code>PhasePartition_equil</code></a></p><p><strong>Fields</strong></p><ul><li><p><code>tot</code></p><p>total specific humidity</p></li><li><p><code>liq</code></p><p>liquid water specific humidity (default: <code>0</code>)</p></li><li><p><code>ice</code></p><p>ice specific humidity (default: <code>0</code>)</p></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/states.jl#L6-L21">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.PhasePartition_equil" href="#CLIMA.MoistThermodynamics.PhasePartition_equil"><code>CLIMA.MoistThermodynamics.PhasePartition_equil</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">PhasePartition_equil(T, ρ, q_tot)</code></pre><p>Partition the phases in equilibrium, returning a <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a> object using the <a href="#CLIMA.MoistThermodynamics.liquid_fraction_equil"><code>liquid_fraction_equil</code></a> function where</p><ul><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li></ul><p>The residual <code>q.tot - q.liq - q.ice</code> is the vapor specific humidity.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L638-L649">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.ThermodynamicState" href="#CLIMA.MoistThermodynamics.ThermodynamicState"><code>CLIMA.MoistThermodynamics.ThermodynamicState</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">ThermodynamicState{DT}</code></pre><p>A thermodynamic state, which can be initialized for various thermodynamic formulations (via its sub-types). All <code>ThermodynamicState</code>&#39;s have access to functions to compute all other thermodynamic properties.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/states.jl#L37-L44">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.PhaseEquil" href="#CLIMA.MoistThermodynamics.PhaseEquil"><code>CLIMA.MoistThermodynamics.PhaseEquil</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">PhaseEquil{DT} &lt;: ThermodynamicState</code></pre><p>A thermodynamic state assuming thermodynamic equilibrium (therefore, saturation adjustment is needed).</p><p><strong>Constructors</strong></p><pre><code class="language-none">PhaseEquil(e_int, q_tot, ρ)</code></pre><p><strong>Fields</strong></p><ul><li><p><code>e_int</code></p><p>internal energy</p></li><li><p><code>q_tot</code></p><p>total specific humidity</p></li><li><p><code>density</code></p><p>density of air (potentially moist)</p></li><li><p><code>T</code></p><p>temperature: computed via <a href="#CLIMA.MoistThermodynamics.saturation_adjustment"><code>saturation_adjustment</code></a></p></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/states.jl#L47-L60">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.PhaseNonEquil" href="#CLIMA.MoistThermodynamics.PhaseNonEquil"><code>CLIMA.MoistThermodynamics.PhaseNonEquil</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">PhaseNonEquil{DT} &lt;: ThermodynamicState</code></pre><p>A thermodynamic state assuming thermodynamic non-equilibrium (therefore, temperature can be computed directly).</p><p><strong>Constructors</strong></p><pre><code class="language-none">PhaseNonEquil(e_int, q::PhasePartition, ρ)</code></pre><p><strong>Fields</strong></p><ul><li><p><code>e_int</code></p><p>internal energy</p></li><li><p><code>q</code></p><p>phase partition</p></li><li><p><code>density</code></p><p>density of air (potentially moist)</p></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/states.jl#L92-L106">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.LiquidIcePotTempSHumEquil" href="#CLIMA.MoistThermodynamics.LiquidIcePotTempSHumEquil"><code>CLIMA.MoistThermodynamics.LiquidIcePotTempSHumEquil</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">LiquidIcePotTempSHumEquil(θ_liq_ice, q_tot, ρ, p)</code></pre><p>Constructs a <a href="#CLIMA.MoistThermodynamics.PhaseEquil"><code>PhaseEquil</code></a> thermodynamic state from liquid-ice potential temperature.</p><ul><li><code>θ_liq_ice</code> - liquid-ice potential temperature</li><li><code>q_tot</code> - total specific humidity</li><li><code>ρ</code> - density</li><li><code>p</code> - pressure</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/states.jl#L74-L83">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.air_density" href="#CLIMA.MoistThermodynamics.air_density"><code>CLIMA.MoistThermodynamics.air_density</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">air_density(T, p[, q::PhasePartition])</code></pre><p>The (moist-)air density from the equation of state (ideal gas law) where</p><ul><li><code>T</code> air temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L87-L97">source</a><div><div><pre><code class="language-none">air_density(ts::ThermodynamicState)</code></pre><p>The (moist-)air density from the equation of state (ideal gas law), given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L102-L107">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.air_pressure" href="#CLIMA.MoistThermodynamics.air_pressure"><code>CLIMA.MoistThermodynamics.air_pressure</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">air_pressure(T, ρ[, q::PhasePartition])</code></pre><p>The air pressure from the equation of state (ideal gas law) where:</p><ul><li><code>T</code> air temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L63-L73">source</a><div><div><pre><code class="language-none">air_pressure(ts::ThermodynamicState)</code></pre><p>The air pressure from the equation of state (ideal gas law), given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L77-L82">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.air_temperature" href="#CLIMA.MoistThermodynamics.air_temperature"><code>CLIMA.MoistThermodynamics.air_temperature</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">air_temperature(e_int, q::PhasePartition)</code></pre><p>The air temperature, where</p><ul><li><code>e_int</code> internal energy per unit mass</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L210-L218">source</a><div><div><pre><code class="language-none">air_temperature(ts::ThermodynamicState)</code></pre><p>The air temperature, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L225-L229">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.air_temperature_from_liquid_ice_pottemp" href="#CLIMA.MoistThermodynamics.air_temperature_from_liquid_ice_pottemp"><code>CLIMA.MoistThermodynamics.air_temperature_from_liquid_ice_pottemp</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">air_temperature_from_liquid_ice_pottemp(θ_liq_ice, p[, q::PhasePartition])</code></pre><p>The air temperature, where</p><ul><li><code>θ_liq_ice</code> liquid-ice potential temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L763-L772">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.cp_m" href="#CLIMA.MoistThermodynamics.cp_m"><code>CLIMA.MoistThermodynamics.cp_m</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">cp_m([q::PhasePartition])</code></pre><p>The isobaric specific heat capacity of moist air where, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L132-L138">source</a><div><div><pre><code class="language-none">cp_m(ts::ThermodynamicState)</code></pre><p>The isobaric specific heat capacity of moist air, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L143-L148">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.cv_m" href="#CLIMA.MoistThermodynamics.cv_m"><code>CLIMA.MoistThermodynamics.cv_m</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">cv_m([q::PhasePartition])</code></pre><p>The isochoric specific heat capacity of moist air where optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L152-L158">source</a><div><div><pre><code class="language-none">cv_m(ts::ThermodynamicState)</code></pre><p>The isochoric specific heat capacity of moist air given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L163-L168">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.dry_pottemp" href="#CLIMA.MoistThermodynamics.dry_pottemp"><code>CLIMA.MoistThermodynamics.dry_pottemp</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">dry_pottemp(T, p[, q::PhasePartition])</code></pre><p>The dry potential temperature where</p><ul><li><code>T</code> temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul><pre><code class="language-none"></code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L742-L751">source</a><div><div><pre><code class="language-none">dry_pottemp(ts::ThermodynamicState)</code></pre><p>The dry potential temperature, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L755-L759">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.exner" href="#CLIMA.MoistThermodynamics.exner"><code>CLIMA.MoistThermodynamics.exner</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">exner(p[, q::PhasePartition])</code></pre><p>Compute the Exner function where</p><ul><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L822-L829">source</a><div><div><pre><code class="language-none">exner(ts::ThermodynamicState)</code></pre><p>Compute the Exner function, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L838-L842">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.gas_constant_air" href="#CLIMA.MoistThermodynamics.gas_constant_air"><code>CLIMA.MoistThermodynamics.gas_constant_air</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">gas_constant_air([q::PhasePartition])</code></pre><p>The specific gas constant of moist air given</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L43-L48">source</a><div><div><pre><code class="language-none">gas_constant_air(ts::ThermodynamicState)</code></pre><p>The specific gas constant of moist air given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L53-L58">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.Ice" href="#CLIMA.MoistThermodynamics.Ice"><code>CLIMA.MoistThermodynamics.Ice</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Ice &lt;: Phase</code></pre><p>An ice phase, to dispatch over <a href="#CLIMA.MoistThermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a> and <a href="#CLIMA.MoistThermodynamics.saturation_shum_generic"><code>saturation_shum_generic</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L417-L423">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.internal_energy" href="#CLIMA.MoistThermodynamics.internal_energy"><code>CLIMA.MoistThermodynamics.internal_energy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">internal_energy(T[, q::PhasePartition])</code></pre><p>The internal energy per unit mass, given a thermodynamic state <code>ts</code> or</p><ul><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L234-L242">source</a><div><div><pre><code class="language-none">internal_energy(ts::ThermodynamicState)</code></pre><p>The internal energy per unit mass, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L247-L251">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.internal_energy_sat" href="#CLIMA.MoistThermodynamics.internal_energy_sat"><code>CLIMA.MoistThermodynamics.internal_energy_sat</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">internal_energy_sat(T, ρ, q_tot)</code></pre><p>The internal energy per unit mass in thermodynamic equilibrium at saturation where</p><ul><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L255-L263">source</a><div><div><pre><code class="language-none">internal_energy_sat(ts::ThermodynamicState)</code></pre><p>The internal energy per unit mass in thermodynamic equilibrium at saturation, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L267-L273">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.latent_heat_fusion" href="#CLIMA.MoistThermodynamics.latent_heat_fusion"><code>CLIMA.MoistThermodynamics.latent_heat_fusion</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">latent_heat_fusion(T)</code></pre><p>The specific latent heat of fusion where</p><ul><li><code>T</code> temperature</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L365-L370">source</a><div><div><pre><code class="language-none">latent_heat_fusion(ts::ThermodynamicState)</code></pre><p>The specific latent heat of fusion given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L374-L379">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.latent_heat_sublim" href="#CLIMA.MoistThermodynamics.latent_heat_sublim"><code>CLIMA.MoistThermodynamics.latent_heat_sublim</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">latent_heat_sublim(T::Real)</code></pre><p>The specific latent heat of sublimation where</p><ul><li><code>T</code> temperature</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L347-L352">source</a><div><div><pre><code class="language-none">latent_heat_sublim(ts::ThermodynamicState)</code></pre><p>The specific latent heat of sublimation given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L356-L361">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.latent_heat_vapor" href="#CLIMA.MoistThermodynamics.latent_heat_vapor"><code>CLIMA.MoistThermodynamics.latent_heat_vapor</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">latent_heat_vapor(T::Real)</code></pre><p>The specific latent heat of vaporization where</p><ul><li><code>T</code> temperature</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L329-L334">source</a><div><div><pre><code class="language-none">latent_heat_vapor(ts::ThermodynamicState)</code></pre><p>The specific latent heat of vaporization given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L338-L343">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.Liquid" href="#CLIMA.MoistThermodynamics.Liquid"><code>CLIMA.MoistThermodynamics.Liquid</code></a> — <span class="docstring-category">Type</span>.</div><div><div><pre><code class="language-julia">Liquid &lt;: Phase</code></pre><p>A liquid phase, to dispatch over <a href="#CLIMA.MoistThermodynamics.saturation_vapor_pressure"><code>saturation_vapor_pressure</code></a> and <a href="#CLIMA.MoistThermodynamics.saturation_shum_generic"><code>saturation_shum_generic</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L408-L414">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.liquid_fraction_equil" href="#CLIMA.MoistThermodynamics.liquid_fraction_equil"><code>CLIMA.MoistThermodynamics.liquid_fraction_equil</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">liquid_fraction_equil(T[, q::PhasePartition])</code></pre><p>The fraction of condensate, assuming phase equilibrium, that is liquid where</p><ul><li><code>T</code> temperature</li><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>If <code>q.liq</code> or <code>q.ice</code> are nonzero, the liquid fraction is computed from them.</p><p>Otherwise, the fraction of liquid is a function that is 1 above <code>T_freeze</code> and goes to zero below <code>T_freeze</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L576-L589">source</a><div><div><pre><code class="language-none">liquid_fraction_equil(ts::ThermodynamicState)</code></pre><p>The fraction of condensate that is liquid given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L601-L605">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.liquid_fraction_nonequil" href="#CLIMA.MoistThermodynamics.liquid_fraction_nonequil"><code>CLIMA.MoistThermodynamics.liquid_fraction_nonequil</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">liquid_fraction_nonequil(T[, q::PhasePartition])</code></pre><p>The fraction of condensate, assuming phase non-equilibrium, that is liquid where</p><ul><li><code>T</code> temperature</li><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>If <code>q.liq</code> or <code>q.ice</code> are nonzero, the liquid fraction is computed from them.</p><p>Otherwise, the fraction of liquid is a function that is 1 above <code>T_freeze</code> and goes to zero below <code>T_freeze</code>.</p><div class="admonition todo"><div class="admonition-title">Todo</div><div class="admonition-text"><p>Currently <a href="#CLIMA.MoistThermodynamics.liquid_fraction_nonequil"><code>liquid_fraction_nonequil</code></a> calls <a href="#CLIMA.MoistThermodynamics.liquid_fraction_equil"><code>liquid_fraction_equil</code></a>, but we should implement a more general function here.</p></div></div></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L609-L626">source</a><div><div><pre><code class="language-none">liquid_fraction_nonequil(ts::ThermodynamicState)</code></pre><p>The fraction of condensate that is liquid given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L630-L634">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.liquid_ice_pottemp" href="#CLIMA.MoistThermodynamics.liquid_ice_pottemp"><code>CLIMA.MoistThermodynamics.liquid_ice_pottemp</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">liquid_ice_pottemp(T, p, q::PhasePartition)</code></pre><p>The liquid-ice potential temperature where</p><ul><li><code>T</code> temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L715-L723">source</a><div><div><pre><code class="language-none">liquid_ice_pottemp(ts::ThermodynamicState)</code></pre><p>The liquid-ice potential temperature, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L733-L738">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.liquid_ice_pottemp_sat" href="#CLIMA.MoistThermodynamics.liquid_ice_pottemp_sat"><code>CLIMA.MoistThermodynamics.liquid_ice_pottemp_sat</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">liquid_ice_pottemp_sat(T, p[, q::PhasePartition])</code></pre><p>The saturated liquid ice potential temperature where</p><ul><li><code>T</code> temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L798-L807">source</a><div><div><pre><code class="language-none">liquid_ice_pottemp_sat(ts::ThermodynamicState)</code></pre><p>The liquid potential temperature given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L814-L818">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.moist_gas_constants" href="#CLIMA.MoistThermodynamics.moist_gas_constants"><code>CLIMA.MoistThermodynamics.moist_gas_constants</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">(R_m, cp_m, cv_m, γ_m) = moist_gas_constants([q::PhasePartition])</code></pre><p>Wrapper to compute all gas constants at once, where optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul><p>The function returns a tuple of</p><ul><li><code>R_m</code> <a href="#CLIMA.MoistThermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>cp_m</code> <a href="#CLIMA.MoistThermodynamics.cp_m"><code>cp_m</code></a></li><li><code>cv_m</code> <a href="#CLIMA.MoistThermodynamics.cv_m"><code>cv_m</code></a></li><li><code>γ_m = cp_m/cv_m</code></li></ul><p>Without the specific humidity arguments, the results are that of dry air.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L172-L186">source</a><div><div><pre><code class="language-none">(R_m, cp_m, cv_m, γ_m) = moist_gas_constants(ts::ThermodynamicState)</code></pre><p>Wrapper to compute all gas constants at once, given a thermodynamic state <code>ts</code>.</p><p>The function returns a tuple of</p><ul><li><code>R_m</code> <a href="#CLIMA.MoistThermodynamics.gas_constant_air"><code>gas_constant_air</code></a></li><li><code>cp_m</code> <a href="#CLIMA.MoistThermodynamics.cp_m"><code>cp_m</code></a></li><li><code>cv_m</code> <a href="#CLIMA.MoistThermodynamics.cv_m"><code>cv_m</code></a></li><li><code>γ_m = cp_m/cv_m</code></li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L196-L207">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.saturation_adjustment" href="#CLIMA.MoistThermodynamics.saturation_adjustment"><code>CLIMA.MoistThermodynamics.saturation_adjustment</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">saturation_adjustment(e_int, ρ, q_tot)</code></pre><p>Compute the temperature that is consistent with</p><ul><li><code>e_int</code> internal energy</li><li><code>ρ</code> (moist-)air density</li><li><code>q_tot</code> total specific humidity</li></ul><p>See also <a href="Utilities/@ref"><code>saturation_adjustment_q_t_θ_l</code></a>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L662-L672">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.saturation_excess" href="#CLIMA.MoistThermodynamics.saturation_excess"><code>CLIMA.MoistThermodynamics.saturation_excess</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">saturation_excess(T, ρ, q::PhasePartition)</code></pre><p>The saturation excess in equilibrium where</p><ul><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>The saturation excess is the difference between the total specific humidity <code>q.tot</code> and the saturation specific humidity in equilibrium, and it is defined to be nonzero only if this difference is positive.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L551-L563">source</a><div><div><pre><code class="language-none">saturation_excess(ts::ThermodynamicState)</code></pre><p>Compute the saturation excess in equilibrium, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L567-L572">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.saturation_shum" href="#CLIMA.MoistThermodynamics.saturation_shum"><code>CLIMA.MoistThermodynamics.saturation_shum</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">saturation_shum(T, ρ[, q::PhasePartition])</code></pre><p>Compute the saturation specific humidity, given</p><ul><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a></li></ul><p>If the phase partition <code>q</code> is given, the saturation specific humidity is that over a mixture of liquid and ice, computed in a thermodynamically consistent way from the weighted sum of the latent heats of the respective phase transitions (Pressel et al., JAMES, 2015).  That is, the saturation vapor pressure and from it the saturation specific humidity are computed from a weighted mean of the latent heats of vaporization and sublimation, with the weights given by the fractions of condensate <code>q.liq/(q.liq + q.ice)</code> and <code>q.ice/(q.liq + q.ice)</code> that are liquid and ice, respectively.</p><p>If the condensate specific humidities <code>q.liq</code> and <code>q.ice</code> are not given or are both zero, the saturation specific humidity is that over a mixture of liquid and ice, with the fraction of liquid given by temperature dependent <code>liquid_fraction_equil(T)</code> and the fraction of ice by the complement <code>1 - liquid_fraction_equil(T)</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L490-L512">source</a><div><div><pre><code class="language-none">saturation_shum(ts::ThermodynamicState)</code></pre><p>Compute the saturation specific humidity, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L531-L535">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.saturation_shum_generic" href="#CLIMA.MoistThermodynamics.saturation_shum_generic"><code>CLIMA.MoistThermodynamics.saturation_shum_generic</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">saturation_shum_generic(T, ρ[; phase=Liquid()])</code></pre><p>Compute the saturation specific humidity over a plane surface of condensate, given</p><ul><li><code>T</code> temperature</li><li><code>ρ</code> (moist-)air density</li></ul><p>and, optionally,</p><ul><li><code>Liquid()</code> indicating condensate is liquid</li><li><code>Ice()</code> indicating condensate is ice</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L474-L484">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.saturation_vapor_pressure" href="#CLIMA.MoistThermodynamics.saturation_vapor_pressure"><code>CLIMA.MoistThermodynamics.saturation_vapor_pressure</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">saturation_vapor_pressure(T, Liquid())</code></pre><p>Return the saturation vapor pressure over a plane liquid surface at temperature <code>T</code>.</p><pre><code class="language-none">saturation_vapor_pressure(T, Ice())</code></pre><p>Return the saturation vapor pressure over a plane ice surface at temperature <code>T</code>.</p><pre><code class="language-none">saturation_vapor_pressure(T, LH_0, Δcp)</code></pre><p>Compute the saturation vapor pressure over a plane surface by integration of the Clausius-Clepeyron relation.</p><p>The Clausius-Clapeyron relation</p><pre><code class="language-none">dlog(p_v_sat)/dT = [LH_0 + Δcp * (T-T_0)]/(R_v*T^2)</code></pre><p>is integrated from the triple point temperature <code>T_triple</code>, using Kirchhoff&#39;s relation</p><pre><code class="language-none">L = LH_0 + Δcp * (T - T_0)</code></pre><p>for the specific latent heat <code>L</code> with constant isobaric specific heats of the phases. The linear dependence of the specific latent heat on temperature <code>T</code> allows analytic integration of the Clausius-Clapeyron relation to obtain the saturation vapor pressure <code>p_v_sat</code> as a function of the triple point pressure <code>press_triple</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L426-L457">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.soundspeed_air" href="#CLIMA.MoistThermodynamics.soundspeed_air"><code>CLIMA.MoistThermodynamics.soundspeed_air</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">soundspeed_air(T[, q::PhasePartition])</code></pre><p>The speed of sound in air, where</p><ul><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul><p>Without the specific humidity arguments, the results are that of dry air.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L303-L313">source</a><div><div><pre><code class="language-none">soundspeed_air(ts::ThermodynamicState)</code></pre><p>The speed of sound in air given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L320-L324">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.specific_volume" href="#CLIMA.MoistThermodynamics.specific_volume"><code>CLIMA.MoistThermodynamics.specific_volume</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">specific_volume(T, p[, q::PhasePartition])</code></pre><p>The (moist-)air specific volume from the equation of state (ideal gas law) where</p><ul><li><code>T</code> air temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L110-L120">source</a><div><div><pre><code class="language-none">specific_volume(ts::ThermodynamicState)</code></pre><p>The (moist-)air specific volume from the equation of state (ideal gas law), given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L124-L129">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.total_energy" href="#CLIMA.MoistThermodynamics.total_energy"><code>CLIMA.MoistThermodynamics.total_energy</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">total_energy(e_kin, e_pot, T[, q::PhasePartition])</code></pre><p>The total energy per unit mass, given</p><ul><li><code>e_kin</code> kinetic energy per unit mass</li><li><code>e_pot</code> potential energy per unit mass</li><li><code>T</code> temperature</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L280-L291">source</a><div><div><pre><code class="language-none">total_energy(e_kin, e_pot, ts::ThermodynamicState)</code></pre><p>The total energy per unit mass given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L295-L300">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="CLIMA.MoistThermodynamics.virtual_pottemp" href="#CLIMA.MoistThermodynamics.virtual_pottemp"><code>CLIMA.MoistThermodynamics.virtual_pottemp</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">virtual_pottemp(T, p[, q::PhasePartition])</code></pre><p>The virtual temperature where</p><ul><li><code>T</code> temperature</li><li><code>p</code> pressure</li></ul><p>and, optionally,</p><ul><li><code>q</code> <a href="#CLIMA.MoistThermodynamics.PhasePartition"><code>PhasePartition</code></a>. Without this argument the results are that of dry air.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L776-L785">source</a><div><div><pre><code class="language-none">virtual_pottemp(ts::ThermodynamicState)</code></pre><p>The virtual potential temperature, given a thermodynamic state <code>ts</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/climate-machine/CLIMA/blob/6c84e0a860b185468f7218ebd144641b32bb2228/src/Utilities/MoistThermodynamics/src/MoistThermodynamics.jl#L789-L794">source</a></section><footer><hr/><a class="previous" href="../RootSolvers/"><span class="direction">Previous</span><span class="title">RootSolvers</span></a><a class="next" href="../../Atmos/SurfaceFluxes/"><span class="direction">Next</span><span class="title"><code>SurfaceFluxes</code></span></a></footer></article></body></html>
